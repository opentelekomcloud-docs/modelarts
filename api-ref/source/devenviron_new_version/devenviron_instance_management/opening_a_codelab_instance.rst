:original_name: RunCodeLab.html

.. _RunCodeLab:

Opening a CodeLab Instance
==========================

Function
--------

This API is used to open a free CodeLab instance. After opening it, you can switch to another instance as required.

Constraints
-----------

None

URI
---

POST /v1/{project_id}/notebooks/open

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+---------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                     |
   +============+===========+========+=================================================================================+
   | project_id | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID <modelarts_03_0147>`. |
   +------------+-----------+--------+---------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 2** Request body parameters

   +-----------+-----------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type   | Description                                                                                                                                                                                      |
   +===========+===========+========+==================================================================================================================================================================================================+
   | image_id  | No        | String | Image ID of the CodeLab instance to be opened. If this parameter is left blank, a multi-kernel CPU instance is opened by default. For details, see :ref:`Querying Supported Images <listimage>`. |
   +-----------+-----------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | share_url | No        | String | URL of an IPYNB file encrypted using Base64. The file is downloaded by default when the CodeLab instance is opened.                                                                              |
   +-----------+-----------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type                                                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
   +=================+==========================================================================+=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | action_progress | Array of :ref:`JobProgress <runcodelab__response_jobprogress>` objects   | Instance initialization progress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description     | String                                                                   | Instance description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | endpoints       | Array of :ref:`EndpointsRes <runcodelab__response_endpointsres>` objects | Local IDE (such as PyCharm and vsCode) or SSH client for remotely accessing a notebook instance through SSH.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | fail_reason     | String                                                                   | Instance failure cause                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | feature         | String                                                                   | Instance type. Options: - **DEFAULT**: free CodeLab instance. You can create only one. - **NOTEBOOK**: billed instance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | flavor          | String                                                                   | Instance flavor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | id              | String                                                                   | Instance ID.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | image           | :ref:`Image <runcodelab__response_image>` object                         | Instance image                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | lease           | :ref:`Lease <runcodelab__response_lease>` object                         | Countdown to automatic instance stop.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name            | String                                                                   | Instance name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | pool            | :ref:`Pool <runcodelab__response_pool>` object                           | Basic information about the dedicated pool, which is returned by the instance created in the dedicated pool.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status          | String                                                                   | Instance status Options: \\r\\n-**INIT**: The instance is being initialized. \\r\\n-**CREATING**: The instance is being created. \\r\\n-**STARTING**: The instance is starting. \\r\\n-STOPPING: The instance is stopping. \\r\\n-DELETING: The instance is being deleted.\\r\\n-RUNNING: The instance is running.\\r\\n-STOPPED: The instance is stopped.\\r\\n-SNAPSHOTTING: A snapshot is being taken for the instance (status when the image is being saved).\\r\\n-CREATE_FAILED: The instance fails to be created. \\r\\n-START_FAILED: The instance fails to be started. \\r\\n-DELETE_FAILED: The instance fails to be deleted.\\r\\n-ERROR: An error occurs. \\r\\n-DELETED: The instance is deleted. \\r\\n-FROZEN: The instance is frozen. |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | token           | String                                                                   | Token used for notebook authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | url             | String                                                                   | URL for accessing the notebook instance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | volume          | :ref:`VolumeRes <runcodelab__response_volumeres>` object                 | Storage volume                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | workspace_id    | String                                                                   | Workspace ID. If no workspaces are available, the default value is **0**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _runcodelab__response_jobprogress:

.. table:: **Table 4** JobProgress

   +------------------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Type    | Description                                                                                                                                                                                             |
   +==================+=========+=========================================================================================================================================================================================================+
   | notebook_id      | String  | Instance ID.                                                                                                                                                                                            |
   +------------------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status           | String  | Job status in a specified step. Options: - **WAITING**: The job is waiting to begin. - **PROCESSING**: The job is being processed. - **FAILED**: The job failed. - **COMPLETED**: The task is complete. |
   +------------------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | step             | Integer | Job step. Options: - 1: Storage preparation. - 2: Computing resource preparation. - 3: Network configurations. - 4: Instance initialization.                                                            |
   +------------------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | step_description | String  | Description of a step in a job.                                                                                                                                                                         |
   +------------------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _runcodelab__response_endpointsres:

.. table:: **Table 5** EndpointsRes

   +--------------------+------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter          | Type             | Description                                                                                                                                                                                                                                                                             |
   +====================+==================+=========================================================================================================================================================================================================================================================================================+
   | allowed_access_ips | Array of strings | Whitelist of public IP addresses that are allowed to access the notebook instance through SSH. By default, all public IP addresses can access the notebook instance. If this parameter is specified, only the clients with the specified IP addresses can access the notebook instance. |
   +--------------------+------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | dev_service        | String           | Supported services. Options: - **NOTEBOOK**: You can access the notebook instance using HTTPS.- **SSH**: You can remotely access the notebook instance through SSH.                                                                                                                     |
   +--------------------+------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ssh_keys           | Array of strings | List of SSH key pairs. You can set multiple key pairs to access an SSH instance at the same time.                                                                                                                                                                                       |
   +--------------------+------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _runcodelab__response_image:

.. table:: **Table 6** Image

   +-----------+--------+----------------------------------------------------------------------------------------------------+
   | Parameter | Type   | Description                                                                                        |
   +===========+========+====================================================================================================+
   | id        | String | Image ID                                                                                           |
   +-----------+--------+----------------------------------------------------------------------------------------------------+
   | name      | String | Image name.                                                                                        |
   +-----------+--------+----------------------------------------------------------------------------------------------------+
   | swr_path  | String | SWR image address                                                                                  |
   +-----------+--------+----------------------------------------------------------------------------------------------------+
   | type      | String | Image type. Options: - **BUILD_IN**: built-in system image- **DEDICATED**: image saved by the user |
   +-----------+--------+----------------------------------------------------------------------------------------------------+

.. _runcodelab__response_lease:

.. table:: **Table 7** Lease

   +-------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter   | Type    | Description                                                                                                                                                                                                        |
   +=============+=========+====================================================================================================================================================================================================================+
   | create_time | Long    | Time (UTC) when the instance is created, accurate to millisecond.                                                                                                                                                  |
   +-------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | duration    | Long    | Instance running duration, which is calculated based on the instance creation time. If the instance creation time plus the duration is greater than the current time, the system automatically stops the instance. |
   +-------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enable      | Boolean | Whether to enable auto stop of the instance.                                                                                                                                                                       |
   +-------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | update_time | Long    | Time (UTC) when the instance is last updated (excluding the keepalive heartbeat time), accurate to millisecond.                                                                                                    |
   +-------------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _runcodelab__response_pool:

.. table:: **Table 8** Pool

   ========= ====== =================================
   Parameter Type   Description
   ========= ====== =================================
   id        String ID of a dedicated resource pool
   name      String Name of a dedicated resource pool
   ========= ====== =================================

.. _runcodelab__response_volumeres:

.. table:: **Table 9** VolumeRes

   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Type    | Description                                                                                                                                                                                                                                                                                                     |
   +============+=========+=================================================================================================================================================================================================================================================================================================================+
   | capacity   | Integer | Storage capacity. The default value is 5 GB for EVS and 50 GB for EFS. The maximum value is 4,096 GB.                                                                                                                                                                                                           |
   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | category   | String  | Storage category. Options: \\r\\n-**EFS**: Scalable File Service (SFS), which is the default storage. \\r\\n-**EVS**: Elastic Volume Service (EVS). \\r\\n\\r\\n For details about the differences between the two types of storage, see Selecting a Storage Type in DevEnviron.\\r\\n.\\r\\n\\r\\n\\r\\n\\r\\n |
   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | mount_path | String  | Directory of the notebook instance to which OBS storage is mounted. Currently, the directory is **/home/ma-user/work/**.                                                                                                                                                                                        |
   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ownership  | String  | Owner to which the resource belongs. Options: - **MANAGED**: Resources are managed by services.- **DEDICATED**: Resources are managed by the user account. This mode is supported only when the instance category is **EFS**.                                                                                   |
   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status     | String  | EVS disk capacity expansion status, which is **RESIZING** during capacity expansion and does not affect the instance.                                                                                                                                                                                           |
   +------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block::

   { }

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "action_progress" : [ {
       "step" : 1,
       "status" : "WAITING",
       "description" : "Prepare the storage."
     }, {
       "step" : 2,
       "status" : "WAITING",
       "description" : "Prepare the compute resource."
     }, {
       "step" : 3,
       "status" : "WAITING",
       "description" : "Configuring the network."
     }, {
       "step" : 4,
       "status" : "WAITING",
       "description" : "Initialize the notebook instance."
     } ],
     "create_at" : 1638841805440,
     "feature" : "DEFAULT",
     "flavor" : "modelarts.vm.cpu.free",
     "id" : "f9937afa-ca78-45b6-bc12-7ecf42553c48",
     "image" : {
       "description" : "description",
       "id" : "e1a07296-22a8-4f05-8bc8-e936c8e54090",
       "name" : "notebook2.0-mul-kernel-cpu-cp36",
       "swr_path" : ".xxxx.com/atelier/notebook2.0-mul-kernel-cpu-cp36:3.3.2-release_v1",
       "tag" : "3.3.2-release_v1",
       "type" : "BUILD_IN"
     },
     "lease" : {
       "create_at" : 1638841805439,
       "duration" : 3600000,
       "enable" : true,
       "update_at" : 1638841805439
     },
     "name" : "notebook_5ee4bf0e",
     "status" : "CREATING",
     "token" : "58ba50c6-e8ff-245c-4840-49e51aa70737",
     "update_at" : 1638841805440,
     "workspace_id" : "0"
   }

Status Codes
------------

=========== ============
Status Code Description
=========== ============
200         OK
201         Created
401         Unauthorized
403         Forbidden
404         Not Found
=========== ============

Error Codes
-----------

See :ref:`Error Codes <modelarts_03_0095>`.
