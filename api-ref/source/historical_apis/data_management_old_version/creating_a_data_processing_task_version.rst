:original_name: CreateProcessorTaskVersion.html

.. _CreateProcessorTaskVersion:

Creating a Data Processing Task Version
=======================================

Function
--------

This API is used to create a data processing task version.

Debugging
---------

You can debug this API through automatic authentication in or use the SDK sample code generated by API Explorer.

URI
---

POST /v2/{project_id}/processor-tasks/{task_id}/versions

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                                                               |
   +============+===========+========+===========================================================================================================================+
   | project_id | Yes       | String | Project ID. For details about how to obtain a project ID, see :ref:`Obtaining a Project ID and Name <modelarts_03_0147>`. |
   +------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------+
   | task_id    | Yes       | String | ID of a data processing task.                                                                                             |
   +------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 2** Request body parameters

   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type                                                                                                    | Description                                                                                                                                             |
   +=================+=================+=========================================================================================================+=========================================================================================================================================================+
   | create_version  | No              | Boolean                                                                                                 | Whether to synchronously create a task version when creating a task. Options:                                                                           |
   |                 |                 |                                                                                                         |                                                                                                                                                         |
   |                 |                 |                                                                                                         | -  **true**: Create a task version when creating a task.                                                                                                |
   |                 |                 |                                                                                                         |                                                                                                                                                         |
   |                 |                 |                                                                                                         | -  **false**: Do not create a task version when creating a task. (Default value)                                                                        |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | data_source     | No              | :ref:`ProcessorDataSource <en-us_topic_0000002268768393__request_processordatasource>` object           | Data source. Either this parameter or **inputs** is delivered.                                                                                          |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description     | No              | String                                                                                                  | Description of a data processing task. The description contains 0 to 256 characters and does not support the following special characters: ``^!<>=&"'`` |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | inputs          | No              | Array of :ref:`ProcessorDataSource <en-us_topic_0000002268768393__request_processordatasource>` objects | Data source list. Either this parameter or **data_source** is delivered.                                                                                |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name            | Yes             | String                                                                                                  | Name of a data processing task.                                                                                                                         |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | template        | No              | :ref:`TemplateParam <en-us_topic_0000002268768393__request_templateparam>` object                       | Data processing template, such as the algorithm ID and parameters.                                                                                      |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version_id      | No              | String                                                                                                  | Dataset version ID.                                                                                                                                     |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | work_path       | No              | :ref:`WorkPath <en-us_topic_0000002268768393__request_workpath>` object                                 | Working directory of a data processing task.                                                                                                            |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
   | workspace_id    | No              | String                                                                                                  | Workspace ID. If no workspace is created, the default value is **0**. If a workspace is created and used, use the actual value.                         |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _en-us_topic_0000002268768393__request_processordatasource:

.. table:: **Table 3** ProcessorDataSource

   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                                                  |
   +=================+=================+=================+==============================================================================================================================================================================+
   | name            | No              | String          | Dataset name.                                                                                                                                                                |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | source          | No              | String          | Data source path. Options:                                                                                                                                                   |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  If **type** is set to **OBS**, **source** is an OBS path.                                                                                                                 |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  If **type** is set to **TASK**, **source** is a task ID.                                                                                                                  |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  If **type** is set to **DATASET**, **source** is a dataset ID.                                                                                                            |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  If **type** is set to **CUSTOM** and the API is called by resource tenants, set **source** to the **project_id** of the actual user. Otherwise, this field is left blank. |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | type            | No              | String          | Data source type. Options:                                                                                                                                                   |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  **OBS**: Data obtained from OBS                                                                                                                                           |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  **TASK**: Data processing task                                                                                                                                            |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  **DATASET**: Dataset                                                                                                                                                      |
   |                 |                 |                 |                                                                                                                                                                              |
   |                 |                 |                 | -  **CUSTOM**: Data called by resource tenants                                                                                                                               |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version_id      | No              | String          | Version of a dataset.                                                                                                                                                        |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version_name    | No              | String          | Dataset version name.                                                                                                                                                        |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _en-us_topic_0000002268768393__request_templateparam:

.. table:: **Table 4** TemplateParam

   +-----------------+-----------------+---------------------------------------------------------------------------------------------+--------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type                                                                                        | Description                                                        |
   +=================+=================+=============================================================================================+====================================================================+
   | id              | No              | String                                                                                      | Task type, which is the ID of a data processing template. Options: |
   |                 |                 |                                                                                             |                                                                    |
   |                 |                 |                                                                                             | -  **sys_data_analyse**: feature analysis                          |
   |                 |                 |                                                                                             |                                                                    |
   |                 |                 |                                                                                             | -  **sys_data_cleaning**: data cleansing                           |
   |                 |                 |                                                                                             |                                                                    |
   |                 |                 |                                                                                             | -  **sys_data_augmentation**: data augmentation                    |
   |                 |                 |                                                                                             |                                                                    |
   |                 |                 |                                                                                             | -  **sys_data_validation**: data validation                        |
   |                 |                 |                                                                                             |                                                                    |
   |                 |                 |                                                                                             | -  **sys_data_selection**: data filtering                          |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------+--------------------------------------------------------------------+
   | name            | No              | String                                                                                      | Template name.                                                     |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------+--------------------------------------------------------------------+
   | operator_params | No              | Array of :ref:`OperatorParam <en-us_topic_0000002268768393__request_operatorparam>` objects | Operator parameter list.                                           |
   +-----------------+-----------------+---------------------------------------------------------------------------------------------+--------------------------------------------------------------------+

.. _en-us_topic_0000002268768393__request_operatorparam:

.. table:: **Table 5** OperatorParam

   +------------------------+-----------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter              | Mandatory | Type    | Description                                                                                                                                                                                                                                                                                                                                                                                                                    |
   +========================+===========+=========+================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | advanced_params_switch | No        | Boolean | Advanced parameter switch.                                                                                                                                                                                                                                                                                                                                                                                                     |
   +------------------------+-----------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | id                     | No        | String  | ID of an operator.                                                                                                                                                                                                                                                                                                                                                                                                             |
   +------------------------+-----------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                   | No        | String  | Name of an operator.                                                                                                                                                                                                                                                                                                                                                                                                           |
   +------------------------+-----------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | params                 | No        | Object  | Operator parameter. The parameter type is map<string,object>. Currently, object only supports the types of Boolean, Integer, Long, String, List[/topic/body/section/table/tgroup/tbody/row/entry/p/br {""}) (br] and Map<String,String>. For two special scenarios of object detection and image classification in a data preprocessing task, the value of **task_type** is **object_detection** or **image_classification**.  |
   +------------------------+-----------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _en-us_topic_0000002268768393__request_workpath:

.. table:: **Table 6** WorkPath

   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                              |
   +=================+=================+=================+==========================================================================================================================================+
   | name            | No              | String          | Dataset name.                                                                                                                            |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | output_path     | No              | String          | Output path, for example, /datasets/demo.                                                                                                |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | path            | No              | String          | Working path. Options:                                                                                                                   |
   |                 |                 |                 |                                                                                                                                          |
   |                 |                 |                 | -  If **type** is set to **OBS**, **source** is an OBS path.                                                                             |
   |                 |                 |                 |                                                                                                                                          |
   |                 |                 |                 | -  If **type** is set to **DATASET**, **source** is a dataset ID.                                                                        |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | type            | No              | String          | Type of a working path. Options:                                                                                                         |
   |                 |                 |                 |                                                                                                                                          |
   |                 |                 |                 | -  **OBS**: OBS path                                                                                                                     |
   |                 |                 |                 |                                                                                                                                          |
   |                 |                 |                 | -  **DATASET**: dataset                                                                                                                  |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | version_id      | No              | String          | Version of a dataset.                                                                                                                    |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
   | version_name    | No              | String          | Name of a dataset version. The value can contain 0 to 32 characters. Only digits, letters, underscores (_), and hyphens (-) are allowed. |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 7** Response body parameters

   ========== ====== =====================================
   Parameter  Type   Description
   ========== ====== =====================================
   version_id String Version ID of a data processing task.
   ========== ====== =====================================

Example Requests
----------------

The following is an example of how to create a data validation task version. The task name has been set to **PRE-e77c**.

.. code-block::

   {
     "name" : "PRE-e77c",
     "inputs" : [ {
       "type" : "DATASET",
       "source" : "PYc9H2HGv5BJNwBGXyK",
       "version_id" : "Osc8SZ7TZStiRV4vYkZ"
     } ],
     "work_path" : {
       "type" : "DATASET",
       "path" : "PYc9H2HGv5BJNwBGXyK",
       "version_name" : "V0011"
     },
     "description" : "",
     "template" : {
       "id" : "sys_data_validation",
       "operator_params" : [ {
         "name" : "MetaValidation",
         "advanced_params_switch" : false,
         "params" : {
           "task_type" : "image_classification",
           "dataset_type" : "manifest",
           "source_service" : "select",
           "filter_func" : "data_validation_select",
           "image_max_width" : "1920",
           "image_max_height" : "1920",
           "total_status" : "[0,1,2]"
         }
       } ]
     },
     "workspace_id" : "0"
   }

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "version_id" : "qSaudx2sbPvthHygckA"
   }

Status Codes
------------

=========== ============
Status Code Description
=========== ============
200         OK
401         Unauthorized
403         Forbidden
404         Not Found
=========== ============

Error Codes
-----------

See :ref:`Error Codes <modelarts_03_0095>`.
