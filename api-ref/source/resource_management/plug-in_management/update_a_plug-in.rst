:original_name: PatchPlugin.html

.. _PatchPlugin:

Update a Plug-in
================

Function
--------

This API is used to update a plug-in instance.

URI
---

PATCH /v2/{project_id}/pools/{pool_name}/plugins/{template_name}

.. table:: **Table 1** Path Parameters

   +---------------+-----------+--------+------------------------------------------------------------------------------------------+
   | Parameter     | Mandatory | Type   | Description                                                                              |
   +===============+===========+========+==========================================================================================+
   | project_id    | Yes       | String | Project ID. For details, see :ref:`Obtaining a Project ID and Name <modelarts_03_0147>`. |
   +---------------+-----------+--------+------------------------------------------------------------------------------------------+
   | pool_name     | Yes       | String | Resource pool name.                                                                      |
   +---------------+-----------+--------+------------------------------------------------------------------------------------------+
   | template_name | Yes       | String | Plug-in template name.                                                                   |
   +---------------+-----------+--------+------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 2** Request header parameters

   ============ ========= ====== =============================
   Parameter    Mandatory Type   Description
   ============ ========= ====== =============================
   Content-Type Yes       String application/merge-patch+json.
   ============ ========= ====== =============================

.. table:: **Table 3** Request body parameters

   +-----------+-----------+-----------------------------------------------------------------------------+------------------------------------------+
   | Parameter | Mandatory | Type                                                                        | Description                              |
   +===========+===========+=============================================================================+==========================================+
   | spec      | Yes       | :ref:`PluginSpec <en-us_topic_0000002340898502__request_pluginspec>` object | Request for updating a plug-in instance. |
   +-----------+-----------+-----------------------------------------------------------------------------+------------------------------------------+

.. _en-us_topic_0000002340898502__request_pluginspec:

.. table:: **Table 4** PluginSpec

   +-----------+-----------+-------------------------------------------------------------------------+------------------------------------------------+
   | Parameter | Mandatory | Type                                                                    | Description                                    |
   +===========+===========+=========================================================================+================================================+
   | template  | Yes       | :ref:`Template <en-us_topic_0000002340898502__request_template>` object | Template information of the plug-in instances. |
   +-----------+-----------+-------------------------------------------------------------------------+------------------------------------------------+

.. _en-us_topic_0000002340898502__request_template:

.. table:: **Table 5** Template

   +-----------+-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type               | Description                                                                                                                                                                                                                                                                                                                                                         |
   +===========+===========+====================+=====================================================================================================================================================================================================================================================================================================================================================================+
   | name      | Yes       | String             | Name of the plug-in template to be installed, for example, **log-agent**.                                                                                                                                                                                                                                                                                           |
   +-----------+-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version   | No        | String             | Version of the plug-in to be installed or upgraded.                                                                                                                                                                                                                                                                                                                 |
   +-----------+-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | inputs    | No        | Map<String,Object> | Plug-in template installation parameters (varying depending on the plug-in). During the plug-in upgrade, you need to specify all the installation parameters. If the parameters are not specified, the default values in the plug-in template are used. The current plug-in installation parameters can be obtained through the API for querying plug-in instances. |
   +-----------+-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 6** Response body parameters

   +-----------+------------------------------------------------------------------------------+------------------------------------------+
   | Parameter | Type                                                                         | Description                              |
   +===========+==============================================================================+==========================================+
   | spec      | :ref:`PluginSpec <en-us_topic_0000002340898502__response_pluginspec>` object | Request for updating a plug-in instance. |
   +-----------+------------------------------------------------------------------------------+------------------------------------------+

.. _en-us_topic_0000002340898502__response_pluginspec:

.. table:: **Table 7** PluginSpec

   +-----------+--------------------------------------------------------------------------+------------------------------------------------+
   | Parameter | Type                                                                     | Description                                    |
   +===========+==========================================================================+================================================+
   | template  | :ref:`Template <en-us_topic_0000002340898502__response_template>` object | Template information of the plug-in instances. |
   +-----------+--------------------------------------------------------------------------+------------------------------------------------+

.. _en-us_topic_0000002340898502__response_template:

.. table:: **Table 8** Template

   +-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Type               | Description                                                                                                                                                                                                                                                                                                                                                         |
   +===========+====================+=====================================================================================================================================================================================================================================================================================================================================================================+
   | name      | String             | Name of the plug-in template to be installed, for example, **log-agent**.                                                                                                                                                                                                                                                                                           |
   +-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | version   | String             | Version of the plug-in to be installed or upgraded.                                                                                                                                                                                                                                                                                                                 |
   +-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | inputs    | Map<String,Object> | Plug-in template installation parameters (varying depending on the plug-in). During the plug-in upgrade, you need to specify all the installation parameters. If the parameters are not specified, the default values in the plug-in template are used. The current plug-in installation parameters can be obtained through the API for querying plug-in instances. |
   +-----------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Status code: 400**

.. table:: **Table 9** Response body parameters

   ========== ====== ==============
   Parameter  Type   Description
   ========== ====== ==============
   error_code String Error code.
   error_msg  String Error message.
   ========== ====== ==============

Example Requests
----------------

This API is used to update a plug-in instance.

.. code-block::

   PATCH https://{endpoint}/v2/{project_id}/pools/{pool_name}/plugins/{template_name}

   {
     "spec" : {
       "template" : {
         "version" : "1.6.63",
         "inputs" : {
           "custom" : {
             "enable_dnsconfig_admission" : true,
             "nameserver" : "123.123.123.123",
             "ndots" : "3",
             "search" : "123,234"
           },
           "flavor" : {
             "name" : "custom",
             "replicas" : 2,
             "resources" : [ {
               "limitsCpu" : "234m",
               "limitsMem" : "234Mi",
               "name" : "node-local-dns-admission-controller",
               "replicas" : 1,
               "requestsCpu" : "123m",
               "requestsMem" : "123Mi"
             }, {
               "limitsCpu" : "234m",
               "limitsMem" : "234Mi",
               "name" : "node-local-dns-cache",
               "requestsCpu" : "123m",
               "requestsMem" : "123Mi"
             } ]
           }
         }
       }
     }
   }

Example Responses
-----------------

**Status code: 200**

Request succeeded.

.. code-block::

   {
     "spec" : {
       "template" : {
         "version" : "1.6.63",
         "inputs" : {
           "custom" : {
             "enable_dnsconfig_admission" : true,
             "nameserver" : "123.123.123.123",
             "ndots" : "3",
             "search" : "123,234"
           },
           "flavor" : {
             "name" : "custom",
             "replicas" : 2,
             "resources" : [ {
               "limitsCpu" : "234m",
               "limitsMem" : "234Mi",
               "name" : "node-local-dns-admission-controller",
               "replicas" : 1,
               "requestsCpu" : "123m",
               "requestsMem" : "123Mi"
             }, {
               "limitsCpu" : "234m",
               "limitsMem" : "234Mi",
               "name" : "node-local-dns-cache",
               "requestsCpu" : "123m",
               "requestsMem" : "123Mi"
             } ]
           }
         }
       }
     }
   }

**Status code: 400**

Bad request

.. code-block::

   {
     "error_code" : "ModelArts.50004000",
     "error_msg" : "Bad request."
   }

Status Codes
------------

=========== ==================
Status Code Description
=========== ==================
200         Request succeeded.
400         Bad request
=========== ==================

Error Codes
-----------

See :ref:`Error Codes <modelarts_03_0095>`.
